<section class="admin-shell">
  <header class="admin-header">
    <div>
      <p class="admin-eyebrow">Wohl Admin</p>
      <h2>Store Control Center</h2>
      <p class="admin-subtitle">Inspired by the legacy PHP admin and modernized for a clean Angular workflow.</p>
    </div>
    <div class="header-actions">
      <button class="btn" (click)="refreshData()">Refresh</button>
      <button class="btn btn-primary" (click)="logout()">Logout</button>
    </div>
  </header>

  <section class="stats-grid">
    <article class="stat-card">
      <p>Products</p>
      <strong>{{ productCount() }}</strong>
    </article>
    <article class="stat-card">
      <p>Orders</p>
      <strong>{{ orderCount() }}</strong>
    </article>
    <article class="stat-card">
      <p>Revenue</p>
      <strong>{{ totalRevenue() | currency:'INR' }}</strong>
    </article>
  </section>

  <nav class="tab-nav">
    <button class="tab-btn" [ngClass]="{ active: activeTab() === 'overview' }" (click)="setTab('overview')">Overview</button>
    <button class="tab-btn" [ngClass]="{ active: activeTab() === 'products' }" (click)="setTab('products')">Products</button>
    <button class="tab-btn" [ngClass]="{ active: activeTab() === 'orders' }" (click)="setTab('orders')">Orders</button>
  </nav>

  <section class="card" *ngIf="activeTab() === 'overview'">
    <h3>Quick Insights</h3>
    <p>Use Products tab to manage catalog and Orders tab to monitor checkout activity.</p>
    <div class="overview-grid">
      <div>
        <h4>Latest Products</h4>
        <ul>
          <li *ngFor="let product of products.slice(-5).reverse()">{{ product.name }} Â· {{ product.category }}</li>
        </ul>
      </div>
      <div>
        <h4>Recent Orders</h4>
        <ul>
          <li *ngFor="let order of orders.slice(-5).reverse()">
            #{{ order.id }} - {{ order.customerName }} - {{ order.total | currency:'INR' }}
          </li>
        </ul>
      </div>
    </div>
  </section>

  <section *ngIf="activeTab() === 'products'" class="products-layout">
    <article class="card form-card">
      <h3>{{ editingProductId ? 'Edit Product' : 'Add Product' }}</h3>
      <form class="form-grid" (ngSubmit)="submitProductForm()" #productForm="ngForm">
        <label>
          Product Name
          <input name="name" [(ngModel)]="form.name" required />
        </label>

        <label>
          Category
          <select name="category" [(ngModel)]="form.category" required>
            <option value="men">Men</option>
            <option value="women">Women</option>
            <option value="kid">Kid</option>
            <option value="new">New</option>
          </select>
        </label>

        <label>
          Price
          <input name="price" type="number" min="1" [(ngModel)]="form.price" required />
        </label>

        <label>
          Image URL
          <input name="image" [(ngModel)]="form.image" required />
        </label>

        <label>
          Description
          <textarea name="description" rows="4" [(ngModel)]="form.description" required></textarea>
        </label>

        <div class="form-actions">
          <button type="button" class="btn" (click)="startCreate()">Reset</button>
          <button class="btn btn-primary" [disabled]="!productForm.form.valid || isSubmitting">
            {{ editingProductId ? 'Update Product' : 'Create Product' }}
          </button>
        </div>
      </form>
    </article>

    <article class="card list-card">
      <div class="list-head">
        <h3>Catalog</h3>
        <div class="list-filters">
          <input [ngModel]="search()" (ngModelChange)="search.set($event)" placeholder="Search name or description" />
          <select [ngModel]="selectedCategory()" (ngModelChange)="selectedCategory.set($event)">
            <option value="all">All Categories</option>
            <option value="men">Men</option>
            <option value="women">Women</option>
            <option value="kid">Kid</option>
            <option value="new">New</option>
          </select>
        </div>
      </div>

      <div *ngIf="filteredProducts().length === 0" class="empty">No matching products found.</div>

      <table *ngIf="filteredProducts().length > 0" class="data-table">
        <tr>
          <th>ID</th>
          <th>Name</th>
          <th>Category</th>
          <th>Price</th>
          <th>Actions</th>
        </tr>
        <tr *ngFor="let product of filteredProducts()">
          <td>{{ product.id }}</td>
          <td>
            <strong>{{ product.name }}</strong>
            <p class="description">{{ product.description }}</p>
          </td>
          <td><span class="chip">{{ product.category }}</span></td>
          <td>{{ product.price | currency:'INR' }}</td>
          <td class="row-actions">
            <button class="btn" (click)="editProduct(product)">Edit</button>
            <button class="btn btn-danger" (click)="deleteProduct(product.id)">Delete</button>
          </td>
        </tr>
      </table>
    </article>
  </section>

  <section *ngIf="activeTab() === 'orders'" class="card">
    <div class="list-head">
      <h3>Order Management</h3>
      <p>{{ orders.length }} order(s)</p>
    </div>

    <div *ngIf="orders.length === 0" class="empty">No orders yet.</div>

    <table *ngIf="orders.length > 0" class="data-table">
      <tr>
        <th>Order</th>
        <th>Customer</th>
        <th>Email</th>
        <th>Total</th>
        <th>Status</th>
        <th>Date</th>
      </tr>
      <tr *ngFor="let order of orders.slice().reverse()">
        <td>#{{ order.id }}</td>
        <td>{{ order.customerName }}</td>
        <td>{{ order.email }}</td>
        <td>{{ order.total | currency:'INR' }}</td>
        <td><span class="chip success">{{ order.status }}</span></td>
        <td>{{ order.createdAt | date:'medium' }}</td>
      </tr>
    </table>
  </section>
</section>
